/*
 * generated by Xtext 2.20.0
 */
package io.mdsl.validation;

import org.eclipse.xtext.validation.Check;
import org.eclipse.xtext.validation.EValidatorRegistrar;

import io.mdsl.apiDescription.ApiDescriptionPackage;
import io.mdsl.apiDescription.EndpointContract;
import io.mdsl.apiDescription.ServiceSpecification;

/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
public class EndpointContractValidator extends AbstractAPIDescriptionValidator {

	@Override
	public void register(EValidatorRegistrar registrar) {
		// not needed for classes used as ComposedCheck
	}
	
	@Check
	public void dataContractValidator(final ServiceSpecification specRoot) {
		info("MDSL API Linter activated, checking semantic rules in " + specRoot.getName(), specRoot, ApiDescriptionPackage.Literals.SERVICE_SPECIFICATION__NAME);
	}
	
	
	@Check
	public void reportContractSize(EndpointContract epc) {
		int opsInContract = epc.getOps().size();
		
		if(opsInContract>7) {
			warning(epc.getName() + " exposes " + opsInContract + " operation(s), more than a single HTTP resource can support in its unified method/verb interface", epc, ApiDescriptionPackage.Literals.ENDPOINT_CONTRACT__NAME);		
		}
		else {
			info(epc.getName() + " exposes " + opsInContract + " operation(s)", epc, ApiDescriptionPackage.Literals.ENDPOINT_CONTRACT__NAME);
		}
	}
}
